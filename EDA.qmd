---
title: "EDA"
format: html
editor: visual
---

# Exploratory Data Analysis

```{r}
library(tidyverse)
```


## Introduction


## Data
Read in the data
```{r}
diabetes_data <- read.csv("diabetes_binary_health_indicators_BRFSS2015.csv")
```

```{r}
diabetes_data<- diabetes_data |>
  mutate(Diabetes_binary = factor(Diabetes_binary, levels = c(0,1),
                                  labels = c("no diabetes", 
                                             "diabetes")),
         HighBP = factor(HighBP, levels = c(0,1),
                                  labels = c("not high", "high BP")),
         HighChol = factor(HighChol, levels = c(0,1),
                         labels = c("not high", "high cholesterol")),
         CholCheck = factor(CholCheck, levels = c(0,1),
                            labels = c("no cholesterol check", "yes cholesterol check")),
         Smoker = factor(Smoker, levels = c(0,1), 
                         labels = c("no", "yes")),
         Stroke = factor(Stroke, levels = c(0,1), 
                         labels = c("no", "yes")),
         HeartDiseaseorAttack = factor(HeartDiseaseorAttack, 
                                       levels = c(0,1), 
                         labels = c("no", "yes")),
         PhysActivity = factor(PhysActivity, levels = c(0,1), 
                         labels = c("no", "yes")),
         Fruits = factor(Fruits, levels = c(0,1), 
                         labels = c("no", "yes")),
         Veggies = factor(Veggies, levels = c(0,1), 
                         labels = c("no", "yes")),
         HvyAlcoholConsump = factor(HvyAlcoholConsump, levels =
                                         c(0,1), 
                         labels = c("no", "yes")),
         AnyHealthcare = factor(AnyHealthcare, levels = c(0,1), 
                         labels = c("no", "yes")),
         NoDocbcCost = factor(NoDocbcCost, levels = c(0,1), 
                         labels = c("no", "yes")),
         GenHlth = factor(GenHlth, levels = c(1,2,3,4,5),
                             labels = c("excellent", "very good",
                                        "good", "fair", "poor")),
         DiffWalk = factor(DiffWalk, levels = c(0,1), 
                         labels = c("no", "yes")),
         Sex = factor(Sex, levels = c(0,1), 
                         labels = c("female", "male")),
         Age = as.factor(Age),
         Education = as.factor(Education),
         Income = as.factor(Income)
  )
```

Check for missingness in the data

```{r}
colSums(is.na(diabetes_data))
```

No missingness 

Here we will investigate the columns of the data by looking at column types, checking the summary statistics for the numeric columns and checking the unique values for the categorical variables.

```{r}
str(diabetes_data)
```

```{r}
#psych::describe(diabetes_data)
```

We will first create some summaries related to Diabetes_binary since that will be our response variable later modeling.

Contigency Tables
```{r}
diabetes_count <- table(diabetes_data$Diabetes_binary)
diabetes_count
```
Percentage of people in this dataset who have diabetes
```{r}
diabetes_count[2]/(diabetes_count[1]+diabetes_count[2])
```

```{r}
table(diabetes_data$Diabetes_binary, diabetes_data$HighBP)
```

```{r}
g <- ggplot(data = diabetes_data, aes(x = Diabetes_binary, fill = HighBP))
g + geom_bar()
```

We can see a higher proportion of people with diabetes also have high blood pressure.


```{r}
table(diabetes_data$Diabetes_binary, diabetes_data$HighChol)
```

```{r}
g <- ggplot(data = diabetes_data, aes(x = Diabetes_binary, fill = HighChol))
g + geom_bar()
```

```{r}
g <- ggplot(data = diabetes_data, aes(x = Diabetes_binary, fill = Sex))
g + geom_bar()
```
We have a fairly even split between men and women who are or are not diabetic.

```{r}
g <- ggplot(data = diabetes_data, aes(x = Age))
g + geom_bar() +
  facet_wrap(~ Diabetes_binary)
```

```{r}
g <- ggplot(data = diabetes_data, aes(x = BMI))
g + geom_histogram() +
  facet_wrap(~ Diabetes_binary)
```

